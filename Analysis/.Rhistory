#group_by(display) %>%
#mean_qi(mean)
ggplot(aes(y = display, x = mean)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
geom_halfeyeh() +
coord_cartesian(xlim = c(-0.2, 0.2))
fitted.samples.prereg %>%
group_by(overlap, .draw) %>%
summarise(
mean = mean(.value)
) %>%
spread(overlap, mean) %>%
mutate(mean_diff = `TRUE` - `FALSE`) %>%
gather(estimate, value, -.draw) %>%
ggplot(aes(y = estimate, x = value)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
geom_halfeyeh() +
coord_cartesian(xlim = c(0, 0.6))
post_samples.describe %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = analysis, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.2, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.describe %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
spread(analysis, mean) %>%
mutate(diff = bayes - freq) %>%
ggplot(aes(y = .category, x = diff, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5)) +
coord_cartesian(xlim = c(-0.6, 0.6)) +
scale_x_continuous(breaks = seq(-1, 1, by = 0.2)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap) +
xlab("mean difference (Bayes - Freq)")
post_samples.report %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = analysis, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.2, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.report %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
spread(analysis, mean) %>%
mutate(diff = bayes - freq) %>%
ggplot(aes(y = .category, x = diff, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5)) +
coord_cartesian(xlim = c(-0.6, 0.6)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
scale_x_continuous(breaks = seq(-1, 1, by = 0.2)) +
facet_grid(.~Overlap) +
xlab("mean difference (Bayes - Freq)")
post_samples.describe %>%
mutate(display = ifelse(display == "text_ci_95", "text", "graph")) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = display, x = mean)) +
geom_halfeyeh() +
coord_cartesian(xlim = c(0, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.category~Overlap)
post_samples.describe %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = display, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(0, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.describe %>%
mutate(display = ifelse(display == "text_ci_95", "text", "graph")) %>%
ungroup() %>%
mutate( display = fct_relevel(display, "text") ) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
compare_levels(mean, display) %>%
group_by(Overlap, display, .category) %>%
ggplot(aes(y = .category, x = mean, color = display)) +
geom_halfeyeh() +
coord_cartesian(xlim = c(-0.5, 0.5)) +
scale_x_continuous(breaks = seq(-1, 1, by = 0.2)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap) +
xlab("mean difference (Textual - Graphical)")
post_samples.describe %>%
ungroup() %>%
mutate( display = fct_relevel(display, "text_ci_95") ) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
compare_levels(mean, display, comparison = control) %>%
ggplot(aes(y = .category, x = mean, color = display)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.5, 0.5)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap) +
xlab("mean difference (Textual - Graphical)")
post_samples.report %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = display, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.2, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.report %>%
mutate(display = ifelse(display == "text_ci_95", "text", "graph")) %>%
ungroup() %>%
mutate( display = fct_relevel(display, "text") ) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
compare_levels(mean, display, comparison = control) %>%
ggplot(aes(y = .category, x = mean, color = display)) +
geom_halfeyeh() +
coord_cartesian(xlim = c(-0.4, 0.4)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap) +
xlab("mean difference (Textual - Graphical)")
fitted.samples.describe <- df_correct_describe %>%
ungroup() %>%
data_grid(correct, overlap) %>%
add_fitted_draws(fit_describe_correct, re_formula = NA) %>%
within(levels(.category) <- levels(df_correct_describe$Describe_Results))
fitted.samples.describe %>%
ggplot(aes(x = correct, y = .value))  +
stat_lineribbon(.width = c(.95, .66, .5))  +
scale_fill_brewer(guide = guide_legend(reverse = TRUE)) +
facet_grid(overlap~.category)
fitted.samples.report %>%
ggplot(aes(x = correct, y = .value))  +
stat_lineribbon(.width = c(.95, .66, .5))  +
scale_fill_brewer(guide = guide_legend(reverse = TRUE)) +
facet_grid(overlap~.category)
post_samples.describe %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = analysis, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.2, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.describe %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
spread(analysis, mean) %>%
mutate(diff = bayes - freq) %>%
ggplot(aes(y = .category, x = diff, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5)) +
coord_cartesian(xlim = c(-0.6, 0.6)) +
scale_x_continuous(breaks = seq(-1, 1, by = 0.2)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap) +
xlab("mean difference (Bayes - Freq)")
post_samples.report <- df_results_report %>%
data_grid(display, analysis, Overlap) %>%
add_fitted_draws(fit_report, re_formula = NA) %>%
within(levels(.category) <- levels(df_results_report$Report_Results)) %>%
ungroup()
post_samples.report %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = analysis, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.2, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.report %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = analysis, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.2, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.report %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
spread(analysis, mean) %>%
mutate(diff = bayes - freq) %>%
ggplot(aes(y = .category, x = diff, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5)) +
coord_cartesian(xlim = c(-0.6, 0.6)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
scale_x_continuous(breaks = seq(-1, 1, by = 0.2)) +
facet_grid(.~Overlap) +
xlab("mean difference (Bayes - Freq)")
post_samples.report %>%
group_by(analysis, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = analysis, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.2, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.describe %>%
mutate(display = ifelse(display == "text_ci_95", "text", "graph")) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = display, x = mean)) +
geom_halfeyeh() +
coord_cartesian(xlim = c(0, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.category~Overlap)
post_samples.describe %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = display, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(0, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.describe %>%
mutate(display = ifelse(display == "text_ci_95", "text", "graph")) %>%
ungroup() %>%
mutate( display = fct_relevel(display, "text") ) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
compare_levels(mean, display) %>%
group_by(Overlap, display, .category) %>%
ggplot(aes(y = .category, x = mean, color = display)) +
geom_halfeyeh() +
coord_cartesian(xlim = c(-0.5, 0.5)) +
scale_x_continuous(breaks = seq(-1, 1, by = 0.2)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap) +
xlab("mean difference (Textual - Graphical)")
post_samples.describe %>%
ungroup() %>%
mutate( display = fct_relevel(display, "text_ci_95") ) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
compare_levels(mean, display, comparison = control) %>%
ggplot(aes(y = .category, x = mean, color = display)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.5, 0.5)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap) +
xlab("mean difference (Textual - Graphical)")
post_samples.report %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = display, x = mean, color = .category)) +
stat_pointintervalh(position = position_dodgev(height = 0.5), show.legend = TRUE) +
coord_cartesian(xlim = c(-0.2, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap)
post_samples.describe %>%
mutate(display = ifelse(display == "text_ci_95", "text", "graph"))
post_samples.describe %>%
mutate(display = ifelse(display == "text_ci_95", "text", "graph")) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
ggplot(aes(y = display, x = mean)) +
geom_halfeyeh() +
coord_cartesian(xlim = c(0, 1)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.category~Overlap)
post_samples.report %>%
mutate(display = ifelse(display == "text_ci_95", "text", "graph")) %>%
ungroup() %>%
mutate( display = fct_relevel(display, "text") ) %>%
group_by(display, Overlap, .category, .draw) %>%
summarise (mean = mean(.value) ) %>%
compare_levels(mean, display, comparison = control) %>%
ggplot(aes(y = .category, x = mean, color = display)) +
geom_halfeyeh() +
coord_cartesian(xlim = c(-0.4, 0.4)) +
geom_vline(xintercept = 0, lty = 2, alpha = 0.5) +
facet_grid(.~Overlap) +
xlab("mean difference (Textual - Graphical)")
fitted.samples.describe <- df_correct_describe %>%
ungroup() %>%
data_grid(correct, overlap) %>%
add_fitted_draws(fit_describe_correct, re_formula = NA) %>%
within(levels(.category) <- levels(df_correct_describe$Describe_Results))
fitted.samples.describe %>%
ggplot(aes(x = correct, y = .value))  +
stat_lineribbon(.width = c(.95, .66, .5))  +
scale_fill_brewer(guide = guide_legend(reverse = TRUE)) +
facet_grid(overlap~.category)
fitted.samples.report %>%
ggplot(aes(x = correct, y = .value))  +
stat_lineribbon(.width = c(.95, .66, .5))  +
scale_fill_brewer(guide = guide_legend(reverse = TRUE)) +
facet_grid(overlap~.category)
total <- 801 + 1135
1/total * (562 + 189)
1/total * (193+289)
0.3879132 + 0.2489669
1/total * (327+33)
0.1859504 + 0.6368801
1/total * (658 + 281)
1/total * (12& + 413 + 658 + 281)
1/total * (127 + 413 + 658 + 281)
total <- 10587 + 64238
sum20 <- 6258 + 8059
sum20 / total
sum40 <- sum20 + 2977 + 12309
sum40 / total
sum60 <- sum40 + 1129 + 13669
sum60 / total
sum80 <- sum60 + 51 + 15438
sum80 / total
6258 / (6258 + 8059)
2977 / (2977 + 12309)
1129 / (1129 + 15438)
51 / (51 + 15438)
2736 / 6258
207 / 473
(207 + 147) / 473
(7427 + 10706) / total
(7427 + 2547 + 10706 + 16376) / total
(7427 + 2547 + 10706 + 16376 + 442 + 18486) / total
(8702 + 15882) / total
(8702 + 15882 + 1672 + 23393) / total
8702 / (8702 + 15882)
1672 / (1672 + 23393)
213 / (213 + 24964)
7427 / (10706 + 7427)
2547 / (2547 + 16376)
442 / (442 + 18486)
172 / (172 + 18671)
library(tidyverse)
library(magrittr)
library(rstan)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
library(brms)
library(modelr)
library(tidybayes)
library(ggstance)
df <- read.csv("../Data.csv")
df <- read.csv("../data/Data.csv")
df %<>% mutate(
id = as.factor(id),
white = as.factor(white),
female = as.factor(female),
pquintile = as.factor(pquintile)
) %>%
as.data.frame(.)
head(df)
m1.acm = brm(quintile ~ pquintile + cs(white), data = df, family = "acat", prior=prior(normal(0, 1), class=b), iter = 2500, chains = 2)
summary(m1.acm)
vignette("brms_overview")
df %>%
data_grid(pquintile, white) %>%
add_fitted_draws(m1.acm, re_formula = NA) %>%
group_by(.category, pquintile, white) %>%
#point_interval() %>%
ggplot(aes(y = .category, x = .value, color = white))+
stat_pointintervalh(.width = 0.95, position = position_dodgev(height = 0.5), show.legend = TRUE) +
facet_grid(.~pquintile)
df %>%
data_grid(pquintile, white) %>%
add_fitted_draws(m1.acm, re_formula = NA) %>%
group_by(.category, pquintile, white) %>%
#point_interval() %>%
ggplot(aes(y = .category, x = .value, color = white))+
stat_pointintervalh(.width = 0.95, position = position_dodgev(height = 0.5), show.legend = TRUE) +
facet_grid(.~pquintile)
df %>%
data_grid(pquintile, white) %>%
add_fitted_draws(m1.acm, re_formula = NA) %>%
group_by(.category, pquintile, white) %>%
mean_qi
df %>%
data_grid(pquintile, white) %>%
add_fitted_draws(m1.acm, re_formula = NA) %>%
group_by(.category, pquintile, white)
df %>%
data_grid(pquintile, white) %>%
add_fitted_draws(m1.acm, re_formula = NA) %>%
group_by(.category, pquintile, white) %>%
mean_qi(.value)
load("m1.multilevel.RData")
summary(m1.multilevel)
df %>%
data_grid(pquintile, white) %>%
add_fitted_draws(m1.acm, re_formula = NA) %>%
group_by(white, pquintile, .category) %>%
mean_qi(.value)
0.52517497 + 0.27397398
0.52517497 + 0.27397398 + 0.14839270
0.52517497 + 0.27397398 + 0.14839270 + 0.03870278
0.43536471 + 0.28323581
0.43536471 + 0.28323581 + 0.19144485
0.43536471 + 0.28323581 + 0.19144485 + 0.06234034
0.37903688 + 0.28145820
0.37903688 + 0.28145820 + 0.21744404
0.37903688 + 0.28145820 + 0.21744404 + 0.08095960
0.27506190 + 0.26161108
0.27506190 + 0.26161108	+ 0.25904835
0.27506190 + 0.26161108	+ 0.25904835 + 0.12376633
0.14845438 + 0.20059902
0.14845438 + 0.20059902 + 0.28229013
0.14845438 + 0.20059902 + 0.28229013 + 0.19164764
0.34270723 + 0.27055755
0.34270723 + 0.27055755 + 0.19064257
0.34270723 + 0.27055755 + 0.19064257 + 0.12780278
0.24662232 + 0.24287619
0.24662232 + 0.24287619 + 0.21343173
0.24662232 + 0.24287619 + 0.21343173 + 0.17834078
0.19419629 + 0.21838924
0.19419629 + 0.21838924 + 0.21920888
0.19419629 + 0.21838924 + 0.21920888 + 0.20918641
0.11392921 + 0.16420217
0.11392921 + 0.16420217 + 0.21130060
0.11392921 + 0.16420217 + 0.21130060 + 0.25861267
0.04478964 + 0.09153348
0.04478964 + 0.09153348 + 0.16742898
0.04478964 + 0.09153348 + 0.16742898 + 0.29168501
summary(m1.acm)
data("inhaler")
force(inhaler)
df
m1.acm1 = brm(quintile ~ pquintile + cs(white) + (1|id), data = df, family = "acat", prior=prior(normal(0, 1), class=b), iter = 2500, chains = 2)
summary(m1.acm)
summary(m1.acm)
df %>%
data_grid(pquintile, white)
df %>%
data_grid(pquintile, white) %>%
add_fitted_draws(m1.acm, re_formula = NA)
df %>%
data_grid(pquintile, white) %>%
add_fitted_draws(m1.acm, re_formula = NA) %>%
group_by(white, pquintile, .category) %>%
mean_qi(.value)
stancode(m1.acm)
library(tidyverse)
library(magrittr)
library(rstan)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
library(brms)
library(modelr)
library(tidybayes)
library(ggstance)
df <- read.csv("../data/Data.csv")
df %<>% mutate(
id = as.factor(id),
white = as.factor(white),
female = as.factor(female),
pquintile = as.factor(pquintile)
) %>%
as.data.frame(.)
df <- read.csv("../data/Data.csv")
df %<>% mutate(
id = as.factor(id),
white = as.factor(white),
female = as.factor(female),
pquintile = as.factor(pquintile)
) %>%
as.data.frame(.)
View(df)
df %<>%
select(id, white, female, pwealthqn, wealthqn) %>%
mutate(
id = as.factor(id),
white = as.factor(white),
female = as.factor(female),
pquintile = as.factor(pwealthqn)
) %>%
as.data.frame(.)
View(df)
df %<>%
select(id, white, female, pwealthqn, wealthqn) %>%
rename(
quantile = wealthqn,
pquantile = pwealthqn
) %>%
mutate(
id = as.factor(id),
white = as.factor(white),
female = as.factor(female),
pquantile = as.factor(pquantile)
) %>%
as.data.frame(.)
head(df)
get_prior(quiatile ~ pquantile + cs(white), data = df, family = "acat", prior=prior(normal(0, 1), class=b))
get_prior(quiatile ~ pquantile + cs(white), data = df, family = "acat")
get_prior(quantile ~ pquantile + cs(white), data = df, family = "acat")
library(tidyverse)
library(magrittr)
library(rstan)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
library(brms)
library(modelr)
library(tidybayes)
df <- read.csv("../data/Data.csv")
df %<>%
select(id, white, female, pwealthqn, wealthqn) %>%
rename(
quantile = wealthqn,
pquantile = pwealthqn
) %>%
mutate(
id = as.factor(id),
white = as.factor(white),
female = as.factor(female),
pquantile = as.factor(pquantile)
) %>%
as.data.frame(.)
head(df)
get_prior(quantile ~ pquantile + cs(white), data = df, family = "acat")
m1.acm = brm(quantile ~ pquantile + cs(white), data = df, family = "acat", prior=prior(normal(0, 1), class=b), iter = 5000, warmup = 2000, chains = 2)
