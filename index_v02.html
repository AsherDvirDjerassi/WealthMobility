<!DOCTYPE html>
<html>
	<head>

	<!-- Bootstrap Core JS  -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

	<!-- Bootstrap Core CSS  -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link href="https://fonts.googleapis.com/css?family=Raleway:300,400,500,600,700,800,900" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

	<style>
		h1 {
			font-family: 'Raleway', sans-serif;
			font-weight: 800;
			font-size: 24px;
			line-height: 28px;
		}

		h3 {
			margin-top: 32px;
			margin-bottom: 0px;
			font-family: 'Raleway', sans-serif;
			font-weight: 800;
			font-size: 16px;
			line-height: 21px;
		}

		p {
			font-family: 'Raleway', sans-serif;
			font-weight: 500;
			font-size: 14px;
			line-height: 16px;
		}

		/*a {
			color: #dc2127;
		}

		a:hover,
		a:focus,
		a:active{
		  color: #CC1F24;
		  text-decoration: none;
		}*/

		.graph {
			position: relative;
		}

		.black {
			font-weight: 600;
			color: white;
			background-color: rgba(96, 107, 210, 0.85);
			padding: 4px 8px;
			border-radius: : 4px;
		}

		.white {
			font-weight: 600;
			color: white;
			background-color: rgba(255, 130, 94, 0.85);
			padding: 4px 8px;
		}

		.drop-btn {
			width: 128px !important;
			display: inline-block;
			padding: 6px 12px !important;
			text-align: left;
			margin: 0px 8px;
		}

		text {
			font-family: 'Raleway', sans-serif;
			font-weight: 400;
			font-size: 14px;
			line-height: 14px;
		}

		foreignObject > div {
			font-family: 'Raleway', sans-serif;
			font-weight: 400;
			font-size: 11px;
			line-height: 11px;
			text-align: center;
		}

		@media (min-width: 992px) {
			foreignObject > div {
				font-family: 'Raleway', sans-serif;
				font-weight: 400;
				font-size: 14px;
				line-height: 14px;
				text-align: center;
			}
		}		

		@media (max-width: 992px) {
			foreignObject > div {
				font-family: 'Raleway', sans-serif;
				font-weight: 400;
				font-size: 11px;
				line-height: 11px;
				text-align: center;
			}

			.container {
				width: 100% !important;
			}
		}

		.label-header > foreignObject > div {
			font-weight: 600 !important;
		}

		.label-category > foreignObject > div {
			font-weight: 600 !important;
		}

		div.col-xs-1, div.col-sm-1, div.col-md-1 {
			padding: 0px !important;
		}

		.button {
			width: 108px !important;
			/*display: inline-block;*/
			text-align: center;
			border-radius: 4px;
			background-color: #fff;
			border: 1px solid #dc2127;
			color: #dc2127;
			font-family: 'Raleway', sans-serif;
			font-size: 16px;
			font-weight: 600;
			cursor: pointer;
			padding: 6px 0px !important;
			visibility: hidden;
			margin: auto;
		}

		.button:hover,
		.button:focus,
		.button:active {
			background-color: #dc2127;
			color: #fff;
			font-weight: 500;
		}

		i {
			vertical-align:middle;
		}
	</style>
	<script>
		// Mobility rates
		var black_ratio_quintile_mr = {
			"1": 0.5,
			"2": 0.5,
			"3": 0.5,
			"4": 0.5,
			"5": 0.5
		},
		wealth_scale_mr = {
			"0": {
				"1": [0.343, 0.613, 0.804, 0.932],
				"2": [0.247, 0.489, 0.703, 0.881],
				"3": [0.194, 0.412, 0.632, 0.841],
				"4": [0.114, 0.278, 0.489, 0.748],
				"5": [0.045, 0.136, 0.303, 0.595]
			},
			"1": {
				"1": [0.525, 0.799, 0.947, 0.986],
				"2": [0.435, 0.719, 0.910, 0.972],
				"3": [0.379, 0.66, 0.878, 0.958],
				"4": [0.275, 0.537, 0.796, 0.919],
				"5": [0.148, 0.349, 0.631, 0.823]
			}
		},
		qScale_domain_mr = [0.191, 0.396, 0.593, 0.801];	

		// Wealth structure
		var black_ratio_quintile_ws = {
			"1": 0.437,
			"2": 0.194,
			"3": 0.068,
			"4": 0.011,
			"5": 0.003
		},
		wealth_scale_ws = {
			"0": {
				"1": [0.34, 0.63, 0.803, 0.898],
				"2": [0.225, 0.489, 0.725, 0.877],
				"3": [0.17, 0.384, 0.632, 0.851],
				"4": [0.114, 0.266, 0.476, 0.757],
				"5": [0.067, 0.137, 0.272, 0.583]
			},
			"1": {
				"1": [0.437, 0.75, 0.929, 0.983],
				"2": [0.398, 0.704, 0.948, 0.975],
				"3": [0.378, 0.652, 0.972, 0.999],
				"4": [0.365, 0.657, 0.657, 0.999],
				"5": [0.019, 0.035, 0.479, 0.999]
			}
		},
		qScale_domain_ws = [0.191, 0.396, 0.593, 0.801];
	</script>
	</head>
	<body>
	<div class="container">
		<div class="row">
			<div class="col-md-8">
				<h1>Intergenerational Wealth Mobility and Race: Data Visualization</h1>

				<h3>Introduction</h3>
				<p>We visualize racial differences in intergenerational wealth mobility. Data from the Panel Study of Income Dynamics (PSID) yield information on the total net worth of parents (in the 1980s) and their children (in 2013 and 2015). We display intergenerational mobility across wealth quintiles focusing, first, on mobility rates and, second, on the maintenance of the racial wealth structure.</p>

				<h3>Visualization 1: Mobility Rates</h3>
				<p>displays wealth mobility rates for white and black children.</p>
			</div>
		</div>
	</div>
	<div class="container-fluid">
		<!-- Interactive visualization -->
		<div class="row">
			<div class="col-md-10 col-md-offset-1">
				<h3><span class="black" style="border-radius: 4px">Black</span> and <span class="white" style="border-radius: 4px">White</span> children raised in 
					<span>
						<div class="dropdown" style="display: inline-block;">
							<button class="btn btn-default dropdown-toggle drop-btn" type="button" data-toggle="dropdown">40% - 60%
							<span class="caret"></span></button>
							<ul class="dropdown-menu dropdown-bar">
								<li class="drop-menu-item"><a onclick="draw_flow_mr(div_mr, 5, qScale_domain_mr, black_ratio_quintile_mr, wealth_scale_mr, 5)">top 20%</a></li>
								<li class="drop-menu-item"><a onclick="draw_flow_mr(div_mr, 5, qScale_domain_mr, black_ratio_quintile_mr, wealth_scale_mr, 4)">20% - 40%</a></li>
								<li class="drop-menu-item"><a onclick="draw_flow_mr(div_mr, 5, qScale_domain_mr, black_ratio_quintile_mr, wealth_scale_mr, 3)">40% - 60%</a></li>
								<li class="drop-menu-item"><a onclick="draw_flow_mr(div_mr, 5, qScale_domain_mr, black_ratio_quintile_mr, wealth_scale_mr, 2)">60% - 80%</a></li>
								<li class="drop-menu-item"><a onclick="draw_flow_mr(div_mr, 5, qScale_domain_mr, black_ratio_quintile_mr, wealth_scale_mr, 1)">bottom 20%</a></li>
							</ul>
						</div>
					</span> of the wealth distribution: See where they end up as adults.
				</h3>
				<!-- <p>For every 10,000 children raised in Black and White households each, see where they end up.</p> -->
			</div>
		</div>
		<div class="row" style="margin-top: 40px;">
			<div class="col-xs-1 col-sm-1 col-sm-offset-1">
				<div id='stats-origin-mr'></div>
			</div>
			<div class="col-xs-6 col-sm-6">
				<div id="graph-mr" class="graph"></div>
			</div>
			<div class="col-xs-3 col-sm-3">
				<div id="stats-mr"></div>
			</div>
		</div>
	</div>
	<div class="container">
		<div class="row">
			<div class="col-md-8">
				<h3>Visualization 2: Wealth Structure</h3>
				<!-- <p>These visualizations model the data collected by the survey using a Bayesian ordinal logistic regression model. We estimate the probability of a child ending up in each quintile (dependent variable) and use the parent quintile and the race of each survey respondent, as category-specific effects) as predictors. The visualization depicts an equal number of children born into families of different races and contrasts the probability of where they may end up.</p> -->
				<p>shows that the despite intergenerational fluctuation in wealth, racial gaps in wealth are largely maintained across generations.</p>
			</div>
		</div>
	</div>
	<div class="container-fluid">
		<!-- Interactive visualization -->
		<div class="row">
			<div class="col-sm-8 col-sm-offset-2">
				<h3><span class="black" style="border-radius: 4px">Black</span> and <span class="white" style="border-radius: 4px">White</span> children across the wealth structure
					<!-- <span>
						<div class="dropdown" style="display: inline-block;">
							<button class="btn btn-default dropdown-toggle drop-btn" type="button" data-toggle="dropdown">all
							<span class="caret"></span></button>
							<ul class="dropdown-menu dropdown-bar">
								<li><a onclick="draw_flow(div, 5, qScale_domain, black_ratio_quintile, wealth_scale, 5)">top 20%</a></li>
								<li><a onclick="draw_flow(div, 5, qScale_domain, black_ratio_quintile, wealth_scale, 4)">20% - 40%</a></li>
								<li><a onclick="draw_flow(div, 5, qScale_domain, black_ratio_quintile, wealth_scale, 3)">40% - 60%</a></li>
								<li><a onclick="draw_flow(div, 5, qScale_domain, black_ratio_quintile, wealth_scale, 2)">60% - 80%</a></li>
								<li><a onclick="draw_flow(div, 5, qScale_domain, black_ratio_quintile, wealth_scale, 1)">bottom 20%</a></li>
								<li><a onclick="draw_flow(div, 5, qScale_domain, black_ratio_quintile, wealth_scale)">all</a></li>
							</ul>
						</div>
					</span> --> 
				</h3>
				<div class="reset-button button" onclick="draw_flow_ws(div_ws, 5, qScale_domain_ws, black_ratio_quintile_ws, wealth_scale_ws)">Replay <i class="material-icons">replay</i></div>
			</div>
		</div>
		<div class="row" style="margin-top: 40px;">
			<div class="col-xs-2 col-sm-2 col-sm-offset-1">
				<div class="stats-ws" id="stats-parent-ws"></div>
			</div>
			<div class="col-xs-6 col-sm-6">
				<div id="graph-ws" class="graph"></div>
			</div>
			<div class="col-xs-2 col-sm-2">
				<div class="stats-ws" id="stats-child-ws"></div>
			</div>
		</div>
	</div>
</body>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="scripts/d3-textwrap.min.js" type="text/javascript"></script>
<script src="https://npmcdn.com/regl/dist/regl.js"></script>

<script src="Scripts/interactive.js"></script>
<script src="Scripts/main.js"></script>
<script>
	$(function(){
		$(".dropdown-menu").on('click', 'li a', function(){
			$(".drop-btn:first-child").html($(this).text()+ ' <span class="caret"></span>');
		});
	});

	draw_flow_mr(div_mr, 5, qScale_domain_mr, black_ratio_quintile_mr, wealth_scale_mr, 3);// "all");

	draw_flow_ws(div_ws, 5, qScale_domain_ws, black_ratio_quintile_ws, wealth_scale_ws);
</script>
</html>


